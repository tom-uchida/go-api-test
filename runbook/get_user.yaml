desc: APIテスト

runners:
  req: http://localhost:8080

vars:
  userNames: ["test-name-1", "test-name-2"]

steps:
  createUser:
    desc: "Create User"
    loop: len(vars.userNames)
    req:
      /create-user:
        post:
          body:
            application/json:
              name: "{{ vars.userNames[i] }}"
    test: |
      current.res.status == 200
    dump:
      expr: current.res.body
      
  getUser:
    desc: "Get User"
    req:
      /get-user:
        get:
          body:
            application/json: null
    test: |
      current.res.status == 200 &&
      len(current.res.body.users) == len(vars.userNames)
    dump:
      expr: current.res.body